<!DOCTYPE HTML>
<html>

<head>
    <title>Receipts</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <script src="./node_modules/web3/dist/web3.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <noscript>
        <link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
    <style>
        .invoice-box {
        max-width: 800px;
        margin: auto;
        padding: 30px;
        border: 1px solid #eee;
        box-shadow: 0 0 10px rgba(0, 0, 0, .15);
        font-size: 16px;
        line-height: 24px;
        font-family: 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
        color: #555;
    }

    .invoice-box table {
        width: 100%;
        line-height: inherit;
        text-align: left;
    }

    .invoice-box table td {
        padding: 5px;
        vertical-align: top;
    }

    .invoice-box table tr td:nth-child(2) {
        text-align: right;
    }

    .invoice-box table tr.top table td {
        padding-bottom: 20px;
    }

    .invoice-box table tr.top table td.title {
        font-size: 45px;
        line-height: 45px;
        color: #333;
    }

    .invoice-box table tr.information table td {
        padding-bottom: 40px;
    }

    .invoice-box table tr.heading td {
        background: #eee;
        border-bottom: 1px solid #ddd;
        font-weight: bold;
    }

    .invoice-box table tr.details td {
        padding-bottom: 20px;
    }

    .invoice-box table tr.item td{
        border-bottom: 1px solid #eee;
    }

    .invoice-box table tr.item.last td {
        border-bottom: none;
    }

    .invoice-box table tr.total td:nth-child(2) {
        border-top: 2px solid #eee;
        font-weight: bold;
    }

    @media only screen and (max-width: 600px) {
        .invoice-box table tr.top table td {
            width: 100%;
            display: block;
            text-align: center;
        }

        .invoice-box table tr.information table td {
            width: 100%;
            display: block;
            text-align: center;
        }
    }

    /** RTL **/
    .rtl {
        direction: rtl;
        font-family: Tahoma, 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
    }

    .rtl table {
        text-align: right;
    }

    .rtl table tr td:nth-child(2) {
        text-align: left;
    }
    </style>
</head>

<body class="is-preload">
    <!-- Wrapper -->
    <div id="wrapper">
        <!-- Header -->
        <center><a href="index.html"><img src="images/logo_transparent.png" alt="Smiley face" height="300" width="300"></a></center>
				<br>
        <!-- Nav -->
        <nav id="nav">
            <ul class="links">
                <li><a href="elements.html">Leaderboard</a></li>
                <li><a href="generic.html">Analytics</a></li>
                <li class="active"><a href="bill.html">Receipts</a></li>
                <!--
                            <li class="active"><a href="elements.html">Elements Reference</a></li>-->
            </ul>
            <ul class="icons">
                <li><a href="#" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
                <li><a href="#" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
                <li><a href="#" class="icon fa-instagram"><span class="label">Instagram</span></a></li>
                <li><a href="#" class="icon fa-github"><span class="label">GitHub</span></a></li>
            </ul>
        </nav>
        <!-- Main -->
        <div id="main">
            <!-- Post -->
                    <h2>View your past PG&E receipts</h2>
        <center>
        <div class="invoice-box">
            <table cellpadding="0" cellspacing="0">
                <tr class="top">
                    <td colspan="2">
                        <table>
                            <tr>
                                <td class="title">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/98/Capital_One_logo.svg/1200px-Capital_One_logo.svg.png" style="width:100%; max-width:300px;">
                                </td>
                                <td>
                                    Invoice #: 123<br>
                                    Created: April 1, 2019<br>
                                    Due: February 1, 2015
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr class="information">
                    <td colspan="2">
                        <table>
                            <tr>
                                <td>
                                    Capital One<br>
                                    1680 Capital One Drive<br>
                                    McLean, VA 22102
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                </tr>
                <tr class="heading">
                    <td>
                        Item
                    </td>
                    <td>
                        Price
                    </td>
                </tr>
                <tr class="item">
                    <td>
                        Current Charges
                    </td>
                    <td id="amt">
                        $300.00
                    </td>
                </tr>
                <tr class="item">
                    <td>
                        Amount Due on Previous Statement
                    </td>
                    <td>
                        $75.00
                    </td>
                </tr>
                <tr class="item last">
                    <td>
                        Previous Unpaid Balance
                    </td>
                    <td>
                        $10.00
                    </td>
                </tr>
                <tr class="total">
                    <td></td>
                    <td>
                        Total: $385.00
                    </td>
                </tr>
            </table>
        </div>
    </div>
    </div>
    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrollex.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
       if(typeof web3 !== 'undefined') {
         console.log("Unlock MetaMask");
         web3 = new Web3(web3.currentProvider);
       }
       else {
         console.log("Install MetaMask");
         web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:3000"));
       }
       web3.version.getNetwork((err, netId) => {
  switch (netId) {
    case "1":
      console.log('This is mainnet')
      break
    case "2":
      console.log('This is the deprecated Morden test network.')
      break
    case "3":
      console.log('This is the ropsten test network.')
      break
    case "4":
      console.log('This is the Rinkeby test network.')
      break
    case "42":
      console.log('This is the Kovan test network.')
      break
    default:
      console.log('This is an unknown network.')
  }
})

       web3.eth.defaultAccount=web3.eth.accounts[0];

       var testContract = web3.eth.contract([
	{
		"constant": false,
		"inputs": [
			{
				"name": "carbon_emm",
				"type": "uint256"
			}
		],
		"name": "add_order",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "sort_array",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "view_history",
		"outputs": [
			{
				"name": "",
				"type": "uint256[]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "view_score",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "user",
				"type": "address"
			}
		],
		"name": "view_score_by_address",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			},
			{
				"name": "",
				"type": "address"
			},
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "show_filtered_users",
		"outputs": [
			{
				"name": "",
				"type": "address[]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"name": "no_of_users",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "name",
				"type": "string"
			}
		],
		"name": "add_user",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "user",
				"type": "address"
			},
			{
				"name": "new_score",
				"type": "uint256"
			}
		],
		"name": "update_score",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "user",
				"type": "address"
			}
		],
		"name": "view_history_by_address",
		"outputs": [
			{
				"name": "",
				"type": "uint256[]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "user",
				"type": "address"
			}
		],
		"name": "find_pos",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"name": "filtered_no_of_users",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	}
]);


var test = testContract.at("0x1532806c8f490011bdb58d3c1b0b3e1c8e678085");
console.log(test);
</script>


    <script type="text/javascript">

    var obj;

    var calcEmissions = (units) => {
        return units * 1.004
    };

    var payee;
    var date;
    var payment_amount;
    var id = '5c9fa4e6322fa06b677949e2'


    // GET payment_amount from Alexa
    var getPaymentAmount = {
        "async": true,
        "crossDomain": true,
        "url": "https://www.jsonstore.io/54298701bfa16f8c77653c87b9008c3f3a681c74ca82c59649efc9159f910e46",
        "method": "GET",
        "headers": {
        "Accept": "application/json",
        "x-macys-webservice-client-id": "h4ckathon",
        "cache-control": "no-cache",
        "Postman-Token": "016044df-9f52-4c7a-b00c-a5395782bff3"
        }
    }

    // $.ajax(getPaymentAmount).done(function (response) {
    //     console.log(response.result.receiver);
    //     var obj = response.result.receiver;
    //     $("#amt").val(obj);
    // });

    $.ajax(getPaymentAmount).done(function (response) {
        console.log(response.result.receiver);
        var obj = response.result.receiver;
        test.update_score("0xD91f848796e092De699C535f8eD72024Af079372",obj,(error,result) => (console.log(result)));
        $("#amt").html(obj);
    });

    //GET data
    var dataFromCapitalOne = {
        "async": true,
        "crossDomain": true,
        "url": "http://api.reimaginebanking.com/accounts?key=1ec0d7166feb6612d0618480de29012f",
        "method": "GET",
        "headers": {
            "Content-Type": "application/json",
            "cache-control": "no-cache",
            "Postman-Token": "c09cf7ee-0bdc-4714-8abd-e5ce5a18a182",
            // "Access-Control-Allow-Origin": 'http://http://localhost:3000/'
        },
        "processData": false,
        "data": "",

    }

    $.ajax(dataFromCapitalOne).done(function(response) {
        console.log(response);
        obj  = JSON.stringify(response);
        console.log(response.result[0]);
    });



    // POST data to
    var dataToCapitalOne = {
        "async": true,
        "crossDomain": true,
        "url": "http://api.reimaginebanking.com/accounts/5c9fa4e8322fa06b677949e5/bills?key=1ec0d7166feb6612d0618480de29012f",
        "method": "POST",
        "headers": {
            "Content-Type": "application/json",
            "cache-control": "no-cache",
            "Postman-Token": "ebfc4e69-bd83-42e7-ae7b-64cd005e0ff9"
        },
        "processData": false,
        "data": "{\n  \"status\": \"pending\",\n  \"payee\":" + payee + ",\n  \"nickname\": \"nick\",\n  \"payment_date\":" + date + ",\n  \"recurring_date\": 1,\n \"payment_amount\":" + payment_amount + "\n}"
    }

    $.ajax(dataToCapitalOne).done(function(response) {
        console.log(response);
    });
    </script>
</body>

</html>
